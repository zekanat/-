<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8">
  <title>Запись на занятия</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; }
    .container { max-width: 800px; margin: 0 auto; background: white; padding: 20px; border-radius: 5px; }
    h1 { color: #333; }
    form { margin-bottom: 30px; padding: 15px; border: 1px solid #ddd; border-radius: 5px; }
    label { display: block; margin-top: 10px; }
    input, select { padding: 8px; width: 100%; margin-top: 5px; box-sizing: border-box; }
    button { padding: 10px 20px; margin-top: 15px; background: #28a745; color: white; border: none; cursor: pointer; border-radius: 3px; }
    button:hover { background: #218838; }
    .success { color: green; padding: 10px; background: #d4edda; border: 1px solid #c3e6cb; border-radius: 3px; margin-bottom: 20px; }
    .error { color: red; padding: 10px; background: #f8d7da; border: 1px solid #f5c6cb; border-radius: 3px; margin-bottom: 20px; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    th, td { border: 1px solid #ddd; padding: 10px; text-align: left; }
    th { background: #f8f9fa; }
  </style>
</head>
<body>
<div class="container">
  <h1>Запись на занятия в фитнес‑клубе</h1>
  <p><a href="/">На главную</a></p>
  {% if success %}
    <div class="success">{{ success }}</div>
  {% endif %}
  {% if error %}
    <div class="error">{{ error }}</div>
  {% endif %}
  <form method="post" action="/web2/enroll_client">
    <h2>Запишитесь на занятие</h2>
    <label>Ваше имя:
      <input type="text" name="name" required>
    </label>
    <label>Ваш email:
      <input type="email" name="email" required>
    </label>
    <label>Выберите занятие:
      <select name="scheduled_class_id" required>
        <option value="">-- выберите занятие --</option>
        {% for sc in scheduled_classes %}
          <option value="{{ sc.id }}">{{ sc.start_time }} ({{ sc.current_enrollment }}/{{ sc.max_enrollment }} мест)</option>
        {% endfor %}
      </select>
    </label>
    <button type="submit">Записаться на занятие</button>
  </form>
  <h2>Доступные занятия</h2>
  <table>
    <thead>
      <tr>
        <th>Дата и время</th>
        <th>Тип занятия</th>
        <th>Тренер</th>
        <th>Зал</th>
        <th>Свободных мест</th>
      </tr>
    </thead>
    <tbody>
      {% for sc in scheduled_classes %}
        <tr>
          <td>{{ sc.start_time }}</td>
          <td>
            {% for ct in class_types %}
              {% if ct.id == sc.class_type_id %}{{ ct.name }}{% endif %}
            {% endfor %}
          </td>
          <td>
            {% for t in trainers %}
              {% if t.id == sc.trainer_id %}{{ t.name }}{% endif %}
            {% endfor %}
          </td>
          <td>
            {% for r in rooms %}
              {% if r.id == sc.room_id %}{{ r.name }}{% endif %}
            {% endfor %}
          </td>
          <td>{{ sc.max_enrollment - sc.current_enrollment }}</td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
</body>
</html>
